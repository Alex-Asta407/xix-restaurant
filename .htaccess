# XIX Restaurant - Clean URLs Configuration

# Enable URL rewriting
RewriteEngine On

# Exclude API routes, payment-success, and Node.js routes from HTML rewriting
# These routes are handled by Node.js, not static files
# Note: xix/catering must come BEFORE xix to match correctly
RewriteCond %{REQUEST_URI} ^/(api|payment-success|xix/catering|mirror/catering) [NC]
RewriteRule ^ - [L]

# Exclude /xix and /mirror (but not their sub-paths) from HTML rewriting
RewriteCond %{REQUEST_URI} ^/(xix|mirror)$ [NC]
RewriteRule ^ - [L]

# Remove .html extension from URLs
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^([^\.]+)$ $1.html [NC,L]

# Redirect .html URLs to clean URLs
RewriteCond %{THE_REQUEST} /([^.]+)\.html [NC]
RewriteRule ^ /%1 [NC,L,R=301]

# Handle specific pages
RewriteRule ^menu$ menu.html [L]
RewriteRule ^events$ events.html [L]
RewriteRule ^reservations$ reservations.html [L]
RewriteRule ^admin$ admin.html [L]

# Security headers
Header always set X-Content-Type-Options nosniff
Header always set X-Frame-Options DENY
Header always set X-XSS-Protection "1; mode=block"

# Compression
<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE text/plain
    AddOutputFilterByType DEFLATE text/html
    AddOutputFilterByType DEFLATE text/xml
    AddOutputFilterByType DEFLATE text/css
    AddOutputFilterByType DEFLATE application/xml
    AddOutputFilterByType DEFLATE application/xhtml+xml
    AddOutputFilterByType DEFLATE application/rss+xml
    AddOutputFilterByType DEFLATE application/javascript
    AddOutputFilterByType DEFLATE application/x-javascript
</IfModule>

# Cache control
<IfModule mod_expires.c>
    ExpiresActive on
    ExpiresByType text/css "access plus 1 year"
    ExpiresByType application/javascript "access plus 1 year"
    ExpiresByType image/png "access plus 1 year"
    ExpiresByType image/jpg "access plus 1 year"
    ExpiresByType image/jpeg "access plus 1 year"
</IfModule>
